// test_ffi_from_c.flap - Converting values FROM C to Flap

// Get current time (returns time_t)
time_val = call("time", 0 as ptr)
timestamp = time_val as number
printf("Current Unix timestamp: %f\n", timestamp)

// Get process ID (returns pid_t)
pid = call("getpid")
pid_flap = pid as number
printf("Process ID: %f\n", pid_flap)

// Get string length (returns size_t)
test_str = "Hello, World!"
strlen_result = call("strlen", test_str as cstr)
len_flap = strlen_result as number
printf("String length from C: %f\n", len_flap)

// Get environment variable (returns char*)
home_ptr = call("getenv", "HOME" as cstr)
home_ptr != 0 {
    -> printf("HOME is set\n")
    ~> printf("HOME not set\n")
}

// Call sqrt from libm (returns double)
x = 16.0
sqrt_result = call("sqrt", x as float64)
sqrt_flap = sqrt_result as number
printf("sqrt(%.0f) = %f\n", x, sqrt_flap)

// Get user name (returns char*)
user_ptr = call("getenv", "USER" as cstr)
user_ptr != 0 {
    -> printf("USER is set\n")
}

