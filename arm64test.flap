// ARM64 comprehensive test
println = msg => import "libc" putchar, puts {
  puts(msg)
  putchar(10)
}

fib = n { 0 | 1 => n _ => fib(n - 1) + fib(n - 2) }

factorial = n { 0 | 1 => 1 _ => n * factorial(n - 1) }

sum_list = lst { [] => 0 _ => head(lst) + sum_list(tail(lst)) }

main = {
  println("ARM64 Flap Test Suite")
  println("=====================")
  
  println("Testing fibonacci (should be 55):")
  import "libc" printf { printf("%d\n", fib(10)) }
  
  println("Testing factorial (should be 120):")
  import "libc" printf { printf("%d\n", factorial(5)) }
  
  println("Testing list operations:")
  import "libc" printf { 
    result = sum_list([1, 2, 3, 4, 5])
    printf("Sum of [1,2,3,4,5] = %d\n", result)
  }
  
  println("Testing string operations:")
  str = "Hello from ARM64!"
  import "libc" printf { printf("%s\n", str) }
  
  println("All tests completed!")
  0
}
