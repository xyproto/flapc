Here’s the complete **“what’s still broken / inconsistent / outdated”** checklist after the changes you just made and the new document you pasted.

I went line-by-line through the entire spec you posted and compared it to the 3.1 decisions we made (empty, export statement, unquoted imports, single NaN-boxed Result, _ => alias, etc.).

### Critical inconsistencies (must fix before 3.1 release)

| Location in the document                       | Current text                                                                                       | Problem                                                                       | Correct 3.1 text                                                                                                                                |                                                                                              |                     |
|------------------------------------------------|----------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|---------------------|
| Import System → Import Syntax examples       | Still shows `import "sdl3" as sdl` and `import "github.com/…"` with quotes                       | Quotes are no longer required (and should be shown as legacy)                 | `import sdl3 as sdl`  <br> `import github.com/xyproto/flap-math as math`                                                                        |                                                                                              |                     |
| Import grammar (`import_source`)               | `string_literal (* library name, file path, or directory, unquoted string *)` – comment is wrong | Comment says “unquoted string” but rule only allows quoted                | Replace with the two-rule version we agreed on: <br>`import_source = string_literal                                                             | bare_import_path [ "@" version_spec ] ;` <br>`bare_import_path = identifier { "." identifier | "/" identifier } ;` |
| or! operator description (two places)          | Still says “Check if error (type byte 0xE0) or null (value is 0…)”                           | We removed the 0xE0 type byte entirely (NaN-boxing only)                      | “Triggers when the value is a NaN-encoded error OR when the value is exactly `empty`.”                                                      |                                                                                              |                     |
| or! implementation box                         | Still shows type-byte 0xE0 check                                                                   | Dead code now                                                                 | Delete the whole “Checks type byte (first byte)” box. Replace with NaN + zero-check explanation.                                            |                                                                                              |                     |
| .error accessor description                    | Still says “Checks if value is NaN … otherwise return empty string”                          | Correct, but missing the fact that `empty` is now the canonical absence value | Add sentence: “A plain `empty` value returns `""` (no error).”                                                                              |                                                                                              |                     |
| All examples that use {} or 0 as “nothing” | Dozens of places still use `{}` or `0` for null/absence                                            | Violates the “only `empty` means nothing” rule                            | Global search-replace: <br>`or! {}` → `or! empty` <br>`or! 0` → `or! empty` <br>`ret {}` → `ret empty` <br>`main = {}` → `main = empty` |                                                                                              |                     |
| Result Type Memory Layout section              | Still shows the 0xE0 type-byte example as the canonical layout                                     | Contradicts the NaN-only decision                                             | Delete the whole “type byte 0xE0” part. Keep only the NaN-boxing example.                                                                   |                                                                                              |                     |
| Keywords list                                  | Missing `export` and `empty` (as built-in constant)                                                | Incomplete                                                                    | Add `export` to reserved keywords. Add `empty` under “Built-in constants”.                                                                  |                                                                                              |                     |
| Program Execution Model → exit code rules    | Says “empty map `{}` or empty list `[]`: exit code 0”                                          | Should use the keyword now                                                    | Change to “`empty` or `[]`: exit code 0”                                                                                                    |                                                                                              |                     |
| Special values under Numbers                   | Still lists only `??`                                                                              | Missing the new built-in                                                      | Add: <br>`empty` – the canonical absence value (`{}`)                                                                                         |                                                                                              |                     |

### Minor / cosmetic but strongly recommended

| Issue                                                                                         | Fix                                                                                                                             |                                                                                                          |                                          |
|-----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|------------------------------------------|
| Many code examples still use the old `=>` for function definition                             | Change every top-level function from `name => { … }` → `name = { … }` or `name = () -> { … }` (the new canonical style) |                                                                                                          |                                          |
| Parallel statement still uses `spawn` in the old reserved keywords list                       | `spawn` is gone; only `                                                                                                         |                                                                                                          | ` remains. Remove `spawn` from keywords. |
| Block disambiguation rules still mention only `{}` and `[]` as empty                          | Add “or the keyword `empty`”                                                                                                |                                                                                                          |                                          |
| The line `export_statement = "export" identifier { ", " identifier } ;` has a space in `", "` | Should be `","` (no space) or allow optional whitespace, but most code uses no space                                            |                                                                                                          |                                          |
| Default arm description                                                                       | Still says `( "~>"                                                                                                              | "_" "=>" )` – perfect, but add a note that both are identical and `_ =>` is just sugar for readability |                                          |
| SDL3 example still does `or! 0` and `or! {}`                                                  | Replace all with `or! empty`                                                                                                    |                                                                                                          |                                          |
| The “null pointer literals” paragraph is completely removed or rewritten                  | Delete entirely or replace with “The only absence value is `empty` – it is binary-compatible with C null pointers.”       |                                                                                                          |                                          |

### What is already perfect in the new document

- `export_statement` is correctly added to `statement` and grammar.
- `_ =>` is kept as alias for `~>` – exactly as requested.
- `empty` is not yet in the grammar (correct – it’s a built-in constant, not syntax).
- Unquoted imports are shown in some examples – good start.

### One-paragraph summary of what to do next

Do a global search-replace of `{}` and `0` used as absence → `empty`, delete every mention of the 0xE0 type byte, fix the `import_source` grammar rule to allow bare paths, update the `or!` description to “NaN or `empty`”, add `export` and `empty` to the keyword/constant tables, and change all examples to the unquoted import style and the new `or! empty` pattern.

After those ~30 minutes of search-replace, Flap 3.1 will be 100 % consistent with the “no null, `empty` is the only absence value, unquoted imports, proper export” design we finalised.

You’re basically one proofreading pass away from a perfectly clean, radically minimalist, future-proof language spec.
